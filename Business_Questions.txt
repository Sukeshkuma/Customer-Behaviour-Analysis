1. What is the revenu generated by male vs female customer?

Ans : select gender,sum(purchase_amount_usd) revenue from customer_data
group by gender;

2. Which customers used used a discount but still spent more than the avarage purchase amount?

Ans : select customer_id,purchase_amount_usd from customer_data
where discount_applied='true'
and purchase_amount_usd>=(select trunc(avg(purchase_amount_usd)) from customer_data);

3. Which of the top 5 product with highest review rating?

Ans : select item_purchased,round(avg(review_rating),2) as Avg_Rating from customer_data
group by item_purchased order by Avg_Rating desc limit 5;

4. Compare the avarage purchase amount between standard and express shipping?

Ans: select shipping_type,round(avg(purchase_amount_usd)) avg_shipping_amount
from customer_data
where shipping_type in ('Express','Standard')
group by shipping_type

5. Do Subscribed customer spend more ? Compare avarage spend and total revenue between subscribed and non-subscribed customer?

Ans: select subscription_status,count(customer_id) Total_customer,
round(avg(purchase_amount_usd),2) Avg_spend,
sum(purchase_amount_usd) Total_revenue
from customer_data
group by subscription_status;

6. Which 5 products have the highest % of purchase with discount applied?

Ans: select item_purchased,
round(100 * sum(case when discount_applied='true' then 1 else 0 end)/count(1)) as discount_rate
from customer_data
group by item_purchased
order by discount_rate desc limit 5

7. Segment customer into new,Returning and loyal based on their number of previous purchase and show the count of each segment?

Ans. with Cust_type as (
select customer_id,
(case when previous_purchases < '2' then 'New'
	  when previous_purchases >='2' and previous_purchases<='10' then 'Returning'
	  when previous_purchases>'10' then 'Loyal' 
	  else 'No_segment'end) as segment
from customer_data)

select segment,count(segment) Total_segment 
from Cust_type group by segment order by Total_segment desc;

8. What are the top 3 most purchased product within each category?

Ans. with table_a as (
select item_purchased,category,count(1) Total_Count
from customer_data group by item_purchased,category
order by Total_Count desc),
table_b as (
select item_purchased,category,Total_Count,
row_number() over(partition by category order by Total_Count desc) Ranking
from table_a)

select item_purchased,category,Total_Count from table_b
where Ranking <=3;

9. Are customers who are repeat buyers (more than 5 pervious purchase) also likely to subscribe?

Ans. select subscription_status,count(1) as repeat_buyer
from customer_data 
where previous_purchases>='5'
group by subscription_status;

10. What is the revenue contibution by age group?

Ans. select age_group,sum(purchase_amount_usd) Revenue from
customer_data
group by age_group
order by Revenue desc;



